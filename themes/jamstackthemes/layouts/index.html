{{ define "title" }}Jamstack Themes{{ end }}
{{ define "body_classes" }}page-home has-sidebar{{ end }}

{{ define "meta_description" }}
    {{ $themes := (where .Site.RegularPages "Type" "theme") }}
    {{ $themes := (where $themes ".Params.draft" "!=" true) }}
    {{ $themes := (where $themes ".Params.stale" "!=" true) }}
    {{ $themes := (where $themes ".Params.disabled" "!=" true) }}
    {{ $themeCount := len $themes}}
    <meta name="description" content="The most popular list of themes and starters for Jamstack sites. Over {{ $themeCount }} free static site generator themes for Hugo, Gatsby, Jekyll, Gridsome & more."/>
{{ end }}

{{ define "main" }}
    {{ $themes := (where .Site.RegularPages "Type" "theme") }}
    {{ $themes := (where $themes ".Params.draft" "!=" true) }}
    {{ $themes := (where $themes ".Params.stale" "!=" true) }}
    {{ $themes := (where $themes ".Params.disabled" "!=" true) }}
    {{ $themeCount := len $themes}}

    <div class="wrapper">
        <div class="sidebar">
            <div class="container">
                {{ partial "filters.html" (dict "context" . "countAll" false) }}
                {{ partial "stackbit.html" . }}
            </div>
        </div>

        <div class="main">
            <div class="container">

                <div class="intro">
                    <div class="stackbit-banner">
                        <div class="banner-title-row">
                            <svg width="40" height="40" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M4.95548 2C4.56698 2 4.18229 2.07514 3.82342 2.22113C3.46455 2.36711 3.13854 2.58108 2.86404 2.85078C2.58954 3.12048 2.37193 3.44063 2.22367 3.79292C2.07541 4.1452 1.99941 4.5227 2 4.90383V9.25245C1.99995 9.61039 2.10117 9.96132 2.29239 10.2662C2.4836 10.571 2.75731 10.8178 3.08304 10.9791L6.93033 12.8738V6.8323H13.0842L17.8339 2.16323C17.8948 2.10345 17.8524 2 17.7672 2H4.95548Z" fill="currentColor"/>
                                <path d="M15.0453 18C15.829 17.9998 16.5805 17.6899 17.1346 17.1384C17.6887 16.587 18 15.8392 18 15.0595V10.6482C17.9997 10.2848 17.8978 9.92864 17.7057 9.61955C17.5136 9.31047 17.239 9.06061 16.9124 8.89789L13.0748 6.97089V13.0982H6.92064L2.16341 17.8372C2.10321 17.8972 2.14568 18 2.23065 18H15.0453Z" fill="currentColor"/>
                                </svg>
                            <span>Stackbit: Visual Editing for the Headless Architecture</span>
                        </div>
                        <div class="banner-subtitle-row">
                            Works with your stack. No lock-in, no proprietary components. 
                        </div>
                        <button class="banner-primary-button"><a href="https://www.stackbit.com/for-developers?ref=jst&utm_source=jamstackthemes&utm_medium=referral&utm_campaign=jamstackthemeswebsite">Go to Stackbit</a></button>
                    </div>
                    <div class="intro-heading">
                        <h1 class="intro-title">New Themes <span class="count">(<span class="count-number">{{ $themeCount }}</span>)</span></h1>
                    </div>
                    <div class="intro-description d-none d-md-block">
                      <p>A list of open-source themes and starters for <a href="https://www.jamstack.wtf" target="_blank" rel="noopener">Jamstack</a> sites.
                        Supported by <a href="https://www.stackbit.com/?ref=jst&utm_source=jamstackthemes&utm_medium=referral&utm_campaign=jamstackthemeswebsite">Stackbit</a>.
                        </p>
                    </div>
                    <div class="intro-description d-md-none">
                      <p>A list of themes and starters for <a href="https://www.jamstack.wtf" target="_blank" rel="noopener">Jamstack</a> sites.</p>
                    </div>
                </div>

                {{ partial "sort-buttons.html" . }}

                <div id="grids-homepage" class="row mt-3">
                    {{ range (($themes.ByParam "date").Reverse).ByParam "weight" }}
                        {{ $repoName := printf "%s" (substr (replace .Params.github "/" "-") 19 | urlize) }}
                        {{ $repo := index .Site.Data.themes $repoName }}
                        {{ $stackbit := index .Site.Data.stackbit $repoName }}
                        {{ partial "theme-card.html" (dict "theme" . "repo" $repo "stackbit" $stackbit "site" $.Site) }}
                    {{ end }}
                </div>

            </div>
        </div>
    </div>
{{ end }}

{{ define "footer_js" }}
    {{ $mixitup := resources.Get "js/libs/mixitup.js" }}
    {{ $mixitupMultiFilter := resources.Get "js/libs/mixitup-multifilter.js" }}
    {{ $filterGroups := resources.Get "js/filter/filter-groups.js" }}
    {{ $filterHash := resources.Get "js/filter/filter-hash.js" }}
    {{ $filter := resources.Get "js/filter/filter.js" }}
    {{ $filterToggle := resources.Get "js/filter/filter-toggle.js" }}

    {{ $homeBundle := slice $mixitup $mixitupMultiFilter $filterGroups $filterHash $filter $filterToggle | resources.Concat "js/homeBundle.js" }}

    {{ if .Site.IsServer }}
        <script type="text/javascript" src="{{ $homeBundle.RelPermalink }}"></script>
    {{ else }}
        <script type="text/javascript" src="{{ ($homeBundle | minify | fingerprint).RelPermalink }}"></script>
    {{ end }}
{{ end }}
